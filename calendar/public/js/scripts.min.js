(function() {
    const $ = require(process.env.PWD + '/public/js/jquery-3.1.1.min.js');
    const eventData = require(process.env.PWD + '/data/eventData.js');

    $(document).ready(function() {
        $('#new-event-form').submit(function(e) {
            e.preventDefault();

            $('#new-event-form .alert-danger').hide();

            // Grab data from serialized form
            var data = $(e.target).serializeArray().reduce(function(obj, item) {
                if (!isNaN(item.value)) {
                    obj[item.name] = +item.value;
                } else {
                    obj[item.name] = item.value;
                }
                return obj;
            }, {});

            var month = +$(e.target).data('month');
            var year = +$(e.target).data('year');
            var date = +data.date;

            try {
                eventData.addEvent(new Date(year, month, date), data).then(function(ret) {
                    window.location = $('#home-btn').attr('href');
                });
            } catch (e) {
                $('#new-event-form .alert-danger').text(e);
                $('#new-event-form .alert-danger').show();
            }
        });
    });
})();

(function() {
    const $ = require(process.env.PWD + '/public/js/jquery-3.1.1.min.js');
    const eventData = require(process.env.PWD + '/data/eventData.js');

    $(document).ready(function() {
        eventData.getEvents().then(function(events) {
            var dayEvents = events[$('#left-panel').data('dateid')];

            // Fill in events the current day
            var html = '<ul class="events">';

            for (let event of dayEvents) {
                html += '<li>' + event.title + '</li>';
            }

            html += '</ul>'

            $('#events').html(html);
        });
    });
})();
(function() {
    const $ = require(process.env.PWD + '/public/js/jquery-3.1.1.min.js');
    const eventData = require(process.env.PWD + '/data/eventData.js');

    $(document).ready(function() {
        eventData.getEvents().then(function(events) {
            // Fill in events for each day of the month
            $('.day:not(.filler)').each(function() {
                var dayEvents = events[$(this).attr('id')];

                if (dayEvents) {
                    var html = '<ul class="events">';

                    for (let event of dayEvents) {
                        html += '<li>' + event.title + '</li>';
                    }

                    html += '</ul>'

                    $(this).addClass('has-events').append(html);
                }
            });
        });
    });
})();